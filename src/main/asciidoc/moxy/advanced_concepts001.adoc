[[cse]][#top]##

[width="100%",cols="<50%,>50%",]
|===
a|
Developing JAXB Applications Using EclipseLink MOXy, *Release 4.0* +

a|
[width="99%",cols="20%,^16%,16%,^16%,16%,^16%",]
|===
|  |image:../../dcommon/images/contents.png[Go To Table Of
Contents,width=16,height=16] + | 
|link:../../[image:../../dcommon/images/search.png[Search] +
[.mini]##] | 
|link:../eclipselink_moxy.pdf[image:../../dcommon/images/pdf_icon.png[PDF]]
|===

|===

'''''

[cols="^,^,",]
|===
|link:advanced_concepts.htm[image:../../dcommon/images/larrow.png[Previous,width=16,height=16]]
|link:advanced_concepts002.htm[image:../../dcommon/images/rarrow.png[Next,width=16,height=16]]
| 
|===

[#CHDCGFBI]####[#TLJAX363]####

== Refreshing Metadata

Introduced in EclipseLink MOXy 2.3, you can refresh the `JAXBContext`
metadata at runtime. This allows you to make changes to existing
mappings in a live application environment and see those changes
immediately without having to create a new `JAXBContext`.

In order to use the *Metadata Refresh* feature, your metadata
information must be provided in one of the following formats:

* `javax.xml.transform.Source`
* `org.w3c.dom.Node`
* `org.eclipse.persistence.jaxb.metadata.MetadataSource`

[#TLJAX364]####[#sthref138]####

*_Example 8-1 Refreshing Metadata_*

This example will be bootstrapped from the following EclipseLink OXM
file:

[source,oac_no_warn]
----
<?xml version="1.0"?>
<xml-bindings
      xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
    package-name="example">
    <java-types>
        <java-type name="Root">
            <java-attributes>
                <xml-element java-attribute="name" name="orig-name"/>
            </java-attributes>
        </java-type>
    </java-types>
</xml-bindings>
 
----

The `JAXBContext` is created in the standard way:

[source,oac_no_warn]
----
 
...
ClassLoader classLoader = ClassLoader.getSystemClassLoader();
 
DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
dbf.setNamespaceAware(true);
DocumentBuilder db = dbf.newDocumentBuilder();
InputStream metadataStream = classLoader.getResourceAsStream("example/eclipselink-oxm.xml";
Document metadataDocument = db.parse(metadataStream);
metadataStream.close();
 
Map<String, Object> props = new HashMap<String, Object>(1);
props.put(JAXBContextProperties.OXM_METADATA_SOURCE, metadataDocument);
JAXBContext context = JAXBContextFactory.createContext(new Class[] { Root.class }, props);
...
 
----

At this point, if we were to marshal a `Root` object to XML, it would
look like this:

[source,oac_no_warn]
----
<root>
    <orig-name>RootName</orig-name>
</root>
 
----

For this example, we will modify the metadata Document directly to
change the XML name for the name field. We can then refresh the metadata
using the `refreshMetadata()` API:

[source,oac_no_warn]
----
...
Element xmlElementElement = (Element) metadataDocument.getElementsByTagNameNS("http://www.eclipse.org/eclipselink/xsds/persistence/oxm", "xml-element").item(0);
xmlElementElement.setAttribute("name", "new-name");
JAXBHelper.getJAXBContext(jc).refreshMetadata();
...
 
----

After refreshing metadata, the same `Root` object will be marshalled as
follows:

[source,oac_no_warn]
----
<root>
      <new-name>RootName</new-name>
</root>
----

'''''

[width="66%",cols="50%,^,>50%",]
|===
a|
[width="96%",cols=",^50%,^50%",]
|===
| 
|link:advanced_concepts.htm[image:../../dcommon/images/larrow.png[Previous,width=16,height=16]]
|link:advanced_concepts002.htm[image:../../dcommon/images/rarrow.png[Next,width=16,height=16]]
|===

|http://www.eclipse.org/eclipselink/[image:../../dcommon/images/ellogo.png[EclipseLink,width=150]] +
a|
[width="99%",cols="20%,^16%,16%,^16%,16%,^16%",]
|===
|  |image:../../dcommon/images/contents.png[Go To Table Of
Contents,width=16,height=16] + | 
|link:../../[image:../../dcommon/images/search.png[Search] +
[.mini]##] | 
|link:../eclipselink_moxy.pdf[image:../../dcommon/images/pdf_icon.png[PDF]]
|===

|===

[[copyright]]
Copyright © 2013 by The Eclipse Foundation under the
http://www.eclipse.org/org/documents/epl-v10.php[Eclipse Public License
(EPL)] +
